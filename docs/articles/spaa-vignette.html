<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculating species association and niche overlap using the spaa R package • spaa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Calculating species association and niche overlap using the spaa R package">
<meta property="og:description" content="spaa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spaa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/spaa-vignette.html">Calculating species association and niche overlap using the spaa R package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/helixcn/spaa/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="spaa-vignette_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calculating species association and niche overlap using the spaa R package</h1>
                        <h4 class="author">Jinlong Zhang</h4>
            
            <h4 class="date">2021-03-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/helixcn/spaa/blob/master/vignettes/spaa-vignette.Rmd"><code>vignettes/spaa-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>spaa-vignette.Rmd</code></div>

    </div>

    
    
<p>This tutorial is based on a post (in Chinese) available at: <a href="http://blog.sciencenet.cn/blog-255662-1239853.html" class="uri">http://blog.sciencenet.cn/blog-255662-1239853.html</a></p>
<p>Ecological niche refers to resource allocation (Jintun Zhang, 2004), and is important in many aspects, for example, ordination analysis, community assembly etc. At the community scale, niche is usually quantified by the occurrence and co-occurrence of species. Although a great number of studies have focused on this topic in the past three decades ((in particular in the Chinese literature, e.g., C. W. Sun and S. D. Zhao, 1996; C. H. Guo et al. 1997; Z. M. Shi et al. 2001; J. L. Li and J. T. Zhang, 2010; N. J. Wang et al. 2010), a computer programme for conducting the relevant analysis is lacking. Here we describe spaa, which stands for SPecies Association Analysis, an R package for conducting suche analysis.</p>
<div id="the-installation" class="section level1">
<h1 class="hasAnchor">
<a href="#the-installation" class="anchor"></a>1. The installation</h1>
<p>spaa is an open source package written in R, available on CRAN.</p>
<p>To install, enter the command <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("spaa")</a></code> in the R console, R will ask you to select a CRAN mirror, and the package will be automatically downloaded and installed.</p>
<p>The developing version is available at <code>https://github.com/helixcn/spaa</code>, to install it, type:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/">devtools</a></span><span class="op">)</span>
<span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"helixcn/spaa"</span><span class="op">)</span></code></pre></div>
</div>
<div id="functions-and-datasets-in-spaa" class="section level1">
<h1 class="hasAnchor">
<a href="#functions-and-datasets-in-spaa" class="anchor"></a>2. Functions and datasets in spaa</h1>
<div id="main-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#main-functions" class="anchor"></a>2.1 Main Functions</h2>
<ul>
<li>
<code>data2mat</code>: convert field records into a species-site matrix</li>
<li>
<code>freq.calc</code>: calculate the relative abundance</li>
<li>
<code>niche.overlap</code>: calculate the niche overlap between all the species pairs</li>
<li>
<code>niche.overlap.boot</code>: bootstrap the confidence intervals for niche overlap</li>
<li>
<code>niche.overlap.boot.pair</code>: bootstrap the confidence intervals of niche overlap for each pair of species</li>
<li>
<code>niche.overlap.pair</code>: calculate the niche overlap for each pair of species</li>
<li>
<code>niche.width</code>: calculate niche width</li>
<li>
<code>plotlowertri</code>: visualize distance/similarity matrices</li>
<li>
<code>plotnetwork</code>: visualize network correlation</li>
<li>
<code>sp.assoc</code>: calculate the overall species association</li>
<li>
<code>sp.pair</code>: calculate the association between each pair of species</li>
<li>
<code>sub.sp.matrix</code>: subsetting the community matrix based on relative frequencies</li>
</ul>
</div>
<div id="embedded-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#embedded-datasets" class="anchor"></a>2.2 Embedded datasets</h2>
<ul>
<li>
<code>splist</code>: An example dataframe of species, genus, family</li>
<li>
<code>datasample</code>: An example community matrix (wide format)</li>
<li>
<code>testdata</code>: An example community dataset (long format)</li>
</ul>
</div>
</div>
<div id="calculating-niche-width" class="section level1">
<h1 class="hasAnchor">
<a href="#calculating-niche-width" class="anchor"></a>3. Calculating niche width</h1>
<div id="converting-community-data-into-a-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#converting-community-data-into-a-matrix" class="anchor"></a>3.1 Converting community data into a matrix</h2>
<p>Community data generally needs to be converted to a matrix (Table 1) when calculating diversity indices, species association, niche width, niche overlap, in which each row represents a plot (site, region or track), each column represents a species, and the number indicates the number of individuals.</p>
<p>Table 1 Community species matrix</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th>sp1</th>
<th>sp2</th>
<th>sp3</th>
<th>sp4</th>
<th>sp5</th>
<th>sp6</th>
<th>sp7</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>plot1</td>
<td>3</td>
<td>6</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>plot2</td>
<td>8</td>
<td>0</td>
<td>30</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>plot3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>However, field data are generally recorded in two ways:</p>
<ol style="list-style-type: decimal">
<li>Individual-based Field Record Sheet</li>
<li>Plot-based Record Sheet</li>
</ol>
<div id="individual-based-field-record-sheet" class="section level3">
<h3 class="hasAnchor">
<a href="#individual-based-field-record-sheet" class="anchor"></a>3.1.2 Individual-based Field Record Sheet</h3>
<p>Individual-based Field Record Sheet is often used in forest plots census, in which every tree (usually when DBH &gt;= 1cm) is tagged. Usually, for a woody species, both the main trunk and branches are recorded. The following columns are often included:</p>
<ol style="list-style-type: decimal">
<li>plot: indicates the name of the plot (20mX20m) the tree is located at. The first two digits “01” refers to the first 20mX20m from the origin (west to east), the second “01” refers to the first 20mX20m from the origin along the Y axist (south to north)</li>
<li>tag number: the number on the main trunk</li>
<li>species name: the species name of the individual</li>
<li>x-coordinate: the x coordinate of the individual (usually in a local Cartesian System, the unit is often meters easting from the origin)</li>
<li>y-coordinate: the y coordinate of the individual (usually in a local Cartesian System, the unit is often meters northing from the origin)</li>
<li>branch (0 refers to the main trunk, 1 is the second largest branch, 2 is the third largest branch and so on)</li>
<li>diameter at breast height (DBH, usually in cm)</li>
<li>height (usually in meters)</li>
<li>status (alive, dead but standing, collapsed, etc.)</li>
<li>remark, any thing to markdown</li>
</ol>
<p>Table 1. Field record sheet</p>
<table class="table">
<thead><tr class="header">
<th>plot</th>
<th>tag</th>
<th>species</th>
<th>x</th>
<th>y</th>
<th>branch</th>
<th>dbh</th>
<th>height</th>
<th>status</th>
<th>remark</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0101</td>
<td>btm0101001</td>
<td>sp1</td>
<td>1.5</td>
<td>5.8</td>
<td>0</td>
<td>15</td>
<td>12</td>
<td>alive</td>
<td>tree</td>
</tr>
<tr class="even">
<td>0101</td>
<td>btm0101002</td>
<td>sp2</td>
<td>3.3</td>
<td>12.1</td>
<td>0</td>
<td>12</td>
<td>10</td>
<td>alive</td>
<td>tree</td>
</tr>
</tbody>
</table>
<p>… …</p>
<p>Generating an example community matrix</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0101"</span>, <span class="st">"0101"</span>, <span class="st">"0102"</span><span class="op">)</span>
<span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"btm0101001"</span>, <span class="st">"btm0101002"</span>, <span class="st">"btm0101003"</span> <span class="op">)</span>
<span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sp1"</span>, <span class="st">"sp2"</span>, <span class="st">"sp1"</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">3.3</span>, <span class="fl">4.1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.8</span>, <span class="fl">12.1</span>, <span class="fl">8.9</span><span class="op">)</span>
<span class="va">branch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">dbh</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span>, <span class="fl">5</span><span class="op">)</span>
<span class="va">height</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">10</span>, <span class="fl">8</span><span class="op">)</span>
<span class="va">status</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alive"</span>, <span class="st">"alive"</span>, <span class="st">"alive"</span><span class="op">)</span>
<span class="va">remark</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span><span class="op">)</span>

<span class="va">btmdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">plot</span>, <span class="va">tag</span>, <span class="va">species</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">branch</span>, <span class="va">dbh</span>, <span class="va">height</span>, <span class="va">status</span>, <span class="va">remark</span><span class="op">)</span>

<span class="va">btmdata</span>
<span class="co">#&gt;   plot        tag species   x    y branch dbh height status remark</span>
<span class="co">#&gt; 1 0101 btm0101001     sp1 1.5  5.8      0  15     12  alive       </span>
<span class="co">#&gt; 2 0101 btm0101002     sp2 3.3 12.1      0  12     10  alive       </span>
<span class="co">#&gt; 3 0102 btm0101003     sp1 4.1  8.9      0   5      8  alive</span>

<span class="co"># generate a dataset</span>
<span class="va">btm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">btmdata</span><span class="op">$</span><span class="va">plot</span>, <span class="va">btmdata</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>
<span class="va">btm</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;        sp1 sp2</span>
<span class="co">#&gt;   0101   1   1</span>
<span class="co">#&gt;   0102   1   0</span></code></pre></div>
</div>
<div id="plot-based-record-sheet" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-based-record-sheet" class="anchor"></a>3.1.2 Plot-based Record Sheet</h3>
<p>Plot-based Record is much simpler, generally the first column is the name of plot, the second column is species, and the third column is the number of individuals of the species in the sample. Note the value is usually an integer, but could also be a decimal number when representing importance value (Kent M, 2011, page 175).</p>
<p>Table 2 Sample survey form</p>
<table class="table">
<thead><tr class="header">
<th>plot</th>
<th>species</th>
<th>abundance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>plot1</td>
<td>sp1</td>
<td>3</td>
</tr>
<tr class="even">
<td>plot1</td>
<td>sp2</td>
<td>6</td>
</tr>
<tr class="odd">
<td>plot1</td>
<td>sp3</td>
<td>1</td>
</tr>
<tr class="even">
<td>plot1</td>
<td>sp4</td>
<td>2</td>
</tr>
<tr class="odd">
<td>plot1</td>
<td>sp5</td>
<td>1</td>
</tr>
<tr class="even">
<td>plot2</td>
<td>sp1</td>
<td>8</td>
</tr>
<tr class="odd">
<td>plot2</td>
<td>sp3</td>
<td>30</td>
</tr>
<tr class="even">
<td>plot3</td>
<td>sp4</td>
<td>2</td>
</tr>
<tr class="odd">
<td>plot3</td>
<td>sp2</td>
<td>1</td>
</tr>
<tr class="even">
<td>plot3</td>
<td>sp6</td>
<td>1</td>
</tr>
<tr class="odd">
<td>plot3</td>
<td>sp7</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>The following code converts sample data to a community-species matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/helixcn/spaa">spaa</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">datasample</span><span class="op">)</span>

<span class="va">datasample2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">datasample</span><span class="op">)</span>, <span class="va">datasample</span><span class="op">)</span>

<span class="co"># Convert the modified matrix to the common format of data records</span>
<span class="va">aaa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">datasample2</span>,
            id.vars <span class="op">=</span> <span class="st">"plot"</span>,
            measure.vars <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">datasample2</span><span class="op">)</span>,
            variable.name <span class="op">=</span> <span class="st">"species"</span>,
            value.name <span class="op">=</span> <span class="st">"abundance"</span>,
            factorsAsStrings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># is 0.00 because the species did not occur in some samples</span>
<span class="va">aaa1</span> <span class="op">&lt;-</span> <span class="va">aaa</span><span class="op">[</span><span class="va">aaa</span><span class="op">$</span><span class="va">abundance</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">aaa1</span><span class="op">)</span>
<span class="co">#&gt;   plot           species abundance</span>
<span class="co">#&gt; 1    1 Castanopsis.eyrei     25.58</span>
<span class="co">#&gt; 2    2 Castanopsis.eyrei     28.41</span>
<span class="co">#&gt; 3    3 Castanopsis.eyrei     39.43</span>
<span class="co">#&gt; 4    4 Castanopsis.eyrei     11.53</span>
<span class="co">#&gt; 5    5 Castanopsis.eyrei     35.01</span>
<span class="co">#&gt; 6    6 Castanopsis.eyrei     51.34</span>

<span class="va">bbb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html">acast</a></span><span class="op">(</span><span class="va">aaa1</span>, 
             formula <span class="op">=</span> <span class="va">plot</span> <span class="op">~</span> <span class="va">species</span>, 
             value.var <span class="op">=</span> <span class="st">"abundance"</span>, 
             fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">bbb</span>
<span class="co">#&gt;   Castanopsis.eyrei Schima.superba Rhododendron.ovatum Cyclobalanopsis.glauca</span>
<span class="co">#&gt; 1             25.58           5.95                3.32                  12.10</span>
<span class="co">#&gt; 2             28.41           1.03               13.24                   1.85</span>
<span class="co">#&gt; 3             39.43          14.37                5.06                   0.00</span>
<span class="co">#&gt; 4             11.53           6.45                3.01                   9.04</span>
<span class="co">#&gt; 5             35.01           6.47                0.00                  17.57</span>
<span class="co">#&gt; 6             51.34           8.65                9.96                   0.00</span>
<span class="co">#&gt; 7             26.83          12.11                9.96                   3.07</span>
<span class="co">#&gt; 8             19.80           7.61                2.64                   0.00</span>
<span class="co">#&gt;   Daphniphyllum.oldhamii Loropetalum.chinensis Pinus.massoniana</span>
<span class="co">#&gt; 1                   7.53                 12.10             0.00</span>
<span class="co">#&gt; 2                   4.71                  0.00             0.00</span>
<span class="co">#&gt; 3                  13.71                  4.07             5.14</span>
<span class="co">#&gt; 4                   0.00                  4.12             0.00</span>
<span class="co">#&gt; 5                   0.00                  4.30             2.17</span>
<span class="co">#&gt; 6                   0.95                  0.00             1.08</span>
<span class="co">#&gt; 7                   9.61                  2.89             4.41</span>
<span class="co">#&gt; 8                   3.85                  3.86             9.77</span>
<span class="co">#&gt;   Rhododendron.latoucheae Vaccinium.bracteatum Lithocarpus.glaber</span>
<span class="co">#&gt; 1                    1.07                 6.99               1.21</span>
<span class="co">#&gt; 2                    5.13                 6.81               7.18</span>
<span class="co">#&gt; 3                    1.16                 0.00               0.00</span>
<span class="co">#&gt; 4                    4.49                 0.00               3.71</span>
<span class="co">#&gt; 5                    0.00                 0.00               3.12</span>
<span class="co">#&gt; 6                    2.08                 2.21               0.00</span>
<span class="co">#&gt; 7                    0.00                 0.00               0.00</span>
<span class="co">#&gt; 8                    5.99                 1.95               0.00</span>
<span class="co">#&gt;   Syzygium.buxifolium Castanopsis.tibetana Castanopsis.fargesii</span>
<span class="co">#&gt; 1                0.00                 0.00                 1.01</span>
<span class="co">#&gt; 2                0.00                 0.96                 0.00</span>
<span class="co">#&gt; 3                0.00                 0.00                 0.00</span>
<span class="co">#&gt; 4                1.22                 2.15                 1.40</span>
<span class="co">#&gt; 5                0.00                 0.00                 0.00</span>
<span class="co">#&gt; 6                0.92                 0.00                 0.00</span>
<span class="co">#&gt; 7                2.47                 0.00                 0.00</span>
<span class="co">#&gt; 8                0.00                 0.00                 0.00</span>
<span class="co">#&gt;   Photinia.serrulata</span>
<span class="co">#&gt; 1               0.00</span>
<span class="co">#&gt; 2               1.21</span>
<span class="co">#&gt; 3               0.00</span>
<span class="co">#&gt; 4               0.00</span>
<span class="co">#&gt; 5               0.00</span>
<span class="co">#&gt; 6               0.00</span>
<span class="co">#&gt; 7               0.00</span>
<span class="co">#&gt; 8               0.88</span></code></pre></div>
<p>When the abundance column only contains integers, it can be converted using <code><a href="../reference/data2mat.html">data2mat()</a></code>. Note that the names of the columns should be named <code>"plotname", "species", "abundance"</code> (note R is case sensitive).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/helixcn/spaa">spaa</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">)</span>
<span class="va">testdata</span>
<span class="co">#&gt;    plotname species abundance</span>
<span class="co">#&gt; 1     plot1     sp1         3</span>
<span class="co">#&gt; 2     plot1     sp2         6</span>
<span class="co">#&gt; 3     plot1     sp3         1</span>
<span class="co">#&gt; 4     plot1     sp4         2</span>
<span class="co">#&gt; 5     plot1     sp5         1</span>
<span class="co">#&gt; 6     plot2     sp1         8</span>
<span class="co">#&gt; 7     plot2     sp3        30</span>
<span class="co">#&gt; 8     plot3     sp4         2</span>
<span class="co">#&gt; 9     plot3     sp2         1</span>
<span class="co">#&gt; 10    plot3     sp6         1</span>
<span class="co">#&gt; 11    plot3     sp7         3</span>
<span class="fu"><a href="../reference/data2mat.html">data2mat</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">)</span>
<span class="co">#&gt;        V2</span>
<span class="co">#&gt; plots   sp1 sp2 sp3 sp4 sp5 sp6 sp7</span>
<span class="co">#&gt;   plot1   3   6   1   2   1   0   0</span>
<span class="co">#&gt;   plot2   8   0  30   0   0   0   0</span>
<span class="co">#&gt;   plot3   0   1   0   2   0   1   3</span></code></pre></div>
</div>
</div>
<div id="calculating-species-associations" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-species-associations" class="anchor"></a>3.2 Calculating species associations</h2>
<p>Interspecific associations, including association among all the species and specific association between each pair of species could be computed using spaa (Zhou Xianye et al. 2000; Shi Zuomin et al. 2001; Zhang Siyu and Zheng Shiqun 2002; Zhang Zhiyong et al. 2003; Kang Bing et al. 2005; Wang Wenjin et al. 2007; Wang Naijiang et al. 2010).</p>
<div id="species-association-of-the-community-as-a-whole" class="section level3">
<h3 class="hasAnchor">
<a href="#species-association-of-the-community-as-a-whole" class="anchor"></a>3.2.1 Species association of the community as a whole</h3>
<p>The function <code><a href="../reference/sp.assoc.html">sp.assoc()</a></code> computes the following indices and the output is a list with the following elements.</p>
<ul>
<li>
<code>pi</code>: Species frequency</li>
<li>
<code>N</code>: Number of plots</li>
<li>
<code>S</code>: Number of species</li>
<li>
<code>Tj</code>: Total number of species for each plot</li>
<li>
<code>Numspmean</code>: Mean number of species</li>
<li>
<code>sigmaTsq</code>: Variance of species relative frequency</li>
<li>
<code>STsq</code>: Variance of species number</li>
<li>
<code>var.ratio</code>: Variance ratio</li>
<li>
<code>W</code>: W statiscit: used in comparison with the Chi Square.</li>
</ul>
<p>An example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">)</span>
<span class="va">spmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data2mat.html">data2mat</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">)</span>
<span class="fu"><a href="../reference/sp.assoc.html">sp.assoc</a></span><span class="op">(</span><span class="va">spmatrix</span><span class="op">)</span>
<span class="co">#&gt; $pi</span>
<span class="co">#&gt;       sp1       sp2       sp3       sp4       sp5       sp6       sp7 </span>
<span class="co">#&gt; 0.6666667 0.6666667 0.6666667 0.6666667 0.3333333 0.3333333 0.3333333 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $N</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $S</span>
<span class="co">#&gt; [1] 7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Tj</span>
<span class="co">#&gt; plot1 plot2 plot3 </span>
<span class="co">#&gt;     5     2     4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Numspmean</span>
<span class="co">#&gt; [1] 3.666667</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sigmaTsq</span>
<span class="co">#&gt; [1] 1.555556</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $STsq</span>
<span class="co">#&gt; [1] 1.555556</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $var.ratio</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $W</span>
<span class="co">#&gt; [1] 3</span></code></pre></div>
<div id="variance-of-species-relative-frequency-equation-1-sigmatsq" class="section level4">
<h4 class="hasAnchor">
<a href="#variance-of-species-relative-frequency-equation-1-sigmatsq" class="anchor"></a>1. Variance of species relative frequency (Equation 1) <code>sigmaTsq</code>:</h4>
<p><img src="clip_image001.png" width="164"></p>
</div>
<div id="variance-of-the-number-of-species-equation-2-stsq" class="section level4">
<h4 class="hasAnchor">
<a href="#variance-of-the-number-of-species-equation-2-stsq" class="anchor"></a>2. Variance of the number of species (Equation 2) <code>STsq</code>
</h4>
<p><img src="clip_image002.png" width="208"></p>
</div>
<div id="species-relative-frequency-equation-3-pi" class="section level4">
<h4 class="hasAnchor">
<a href="#species-relative-frequency-equation-3-pi" class="anchor"></a>3. Species’ relative frequency (Equation 3) <code>pi</code>
</h4>
<p><img src="clip_image003.png" width="188"></p>
</div>
<div id="variance-ratio-equation-4-var-ratio" class="section level4">
<h4 class="hasAnchor">
<a href="#variance-ratio-equation-4-var-ratio" class="anchor"></a>4. Variance ratio (Equation 4) <code>var.ratio</code>
</h4>
<p><img src="clip_image004.png" width="232"></p>
<ul>
<li>If <em>VR</em> &gt; 1, positive correlation</li>
<li>if <em>VR</em> &lt; 1, negative correlation</li>
</ul>
</div>
<div id="the-w-statistic-equation-5" class="section level4">
<h4 class="hasAnchor">
<a href="#the-w-statistic-equation-5" class="anchor"></a>5. The <em>W</em> statistic (Equation 5)</h4>
<p>The <em>W</em> statistic is used to test the significance of the variance ratio (Qianmei Zhang et al., 2006) with 95% confidence intervals of Chi 0.95,N2 &lt; <em>W</em> &lt; Chi 0.05, N2</p>
<p><img src="clip_image005.png" width="252"></p>
<p>In Equations 1-5, <em>N</em> is the number of plots, <em>S</em> is the total number of species, <em>n</em> is the number of plots occupied by a species, <em>T_j</em> is the number of species in each plot, and <em>t</em> is the average of the number of species in all plots.</p>
</div>
</div>
<div id="significance-test-of-inters-pecific-associations" class="section level3">
<h3 class="hasAnchor">
<a href="#significance-test-of-inters-pecific-associations" class="anchor"></a>3.2.2 Significance test of inters-pecific associations</h3>
<p>The association between each pair of species could be calculated using the following code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">)</span>
<span class="va">spmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data2mat.html">data2mat</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">)</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sp.pair.html">sp.pair</a></span><span class="op">(</span><span class="va">spmatrix</span><span class="op">)</span></code></pre></div>
<p>In this test, a 2X2 contingent table is usually used. If there are species X and species Y occurring in the plots, <em>a</em>, <em>b</em>, <em>c</em>, <em>d</em> denote co-occurrence and non-occurrence between them, respectively (Kent M., 2012, page 114):</p>
<ul>
<li>
<code>a</code>: Number of plots where both species X and Y are present;</li>
<li>
<code>b</code>: Number of plots where X is present but not Y ;</li>
<li>
<code>c</code>: Number of plots where Y is present but not X;</li>
<li>
<code>d</code>: Number of plots where neither X nor Y is present.</li>
<li>
<code>n</code>: Total number of plot <code>n = a+b+c+d</code>
</li>
</ul>
<p>The Yates-corrected Chi-square is used when determining whether there is a significant association for small samples (Kent M., 2012, page 114).</p>
<p>The output is a list containing the following elements:</p>
<ul>
<li>
<code>chisq</code>: chi square matrix</li>
<li>
<code>chisqass</code>: chi square matrix information</li>
<li>
<code>V</code>: Value indicating species association is positive or negative</li>
<li>
<code>Ochiai</code>: Ochiai’s index</li>
<li>
<code>Dice</code>: Dice’s index</li>
<li>
<code>Jaccard</code>: Jaccard’s index</li>
<li>
<code>Pearson</code>: Pearson’s correlation</li>
<li>
<code>Spearman</code>: Spearman’s rank correlation</li>
<li>
<code>PCC</code>: Point correlation coefficient</li>
<li>
<code>AC</code>: Association coefficient</li>
</ul>
<p>The equations are shown below:</p>
<div id="yates-corrected-chi-square-test-for-significance-equation-6-see-chisq-and-chisqass" class="section level4">
<h4 class="hasAnchor">
<a href="#yates-corrected-chi-square-test-for-significance-equation-6-see-chisq-and-chisqass" class="anchor"></a>1. Yates-corrected chi-square test for significance (Equation 6), see <code>chisq</code> and <code>chisqass</code>
</h4>
<p>Note: - <code>chisqass</code> is the Chi-square - <code>chisq</code> is the Chi-square with Yates’ correction for small samples (Kent M., 2012, page 114)</p>
<p><img src="clip_image006.png" width="316"></p>
</div>
<div id="v-ratio-equation-7-v" class="section level4">
<h4 class="hasAnchor">
<a href="#v-ratio-equation-7-v" class="anchor"></a>2. V ratio (Equation 7) <code>V</code>
</h4>
<p><img src="clip_image007.png" width="180"></p>
<p>Indicating whether the species association is positive (&gt;0) or negative (&lt;0)</p>
</div>
<div id="jaccards-index-equation-8-jaccard" class="section level4">
<h4 class="hasAnchor">
<a href="#jaccards-index-equation-8-jaccard" class="anchor"></a>3. Jaccard’s index (Equation 8) <code>Jaccard</code>:</h4>
<p><img src="clip_image008.png" width="184"></p>
</div>
<div id="ochiai-index-equation-9-ochiai" class="section level4">
<h4 class="hasAnchor">
<a href="#ochiai-index-equation-9-ochiai" class="anchor"></a>4. Ochiai index (Equation 9) <code>Ochiai</code>:</h4>
<p><img src="clip_image009.png" width="179"></p>
</div>
<div id="dice-index-equation-10-dice" class="section level4">
<h4 class="hasAnchor">
<a href="#dice-index-equation-10-dice" class="anchor"></a>5. Dice Index (Equation 10) <code>Dice</code>:</h4>
<p><img src="clip_image010.png" width="142"></p>
</div>
<div id="pcc-point-correlation-coefficient-pcc-equation-11" class="section level4">
<h4 class="hasAnchor">
<a href="#pcc-point-correlation-coefficient-pcc-equation-11" class="anchor"></a>6. <em>PCC</em>: Point Correlation Coefficient <code>PCC</code> (Equation 11)</h4>
<p><img src="clip_image011.png" width="400"></p>
</div>
<div id="ac-association-coefficient-equation-12-ac" class="section level4">
<h4 class="hasAnchor">
<a href="#ac-association-coefficient-equation-12-ac" class="anchor"></a>7. <em>AC</em> Association coefficient (Equation 12) <code>AC</code>
</h4>
<ul>
<li>If <code>a*d &gt;= b*c</code>:</li>
</ul>
<p><img src="clip_image012.png" width="158"></p>
<ul>
<li>If <code>a*d &lt; b*c</code> and <code>d &gt;= a</code>, then (Equation 13):</li>
</ul>
<p><img src="clip_image013.png" width="168"></p>
<ul>
<li>If <code>a*d &lt; b*c</code> and <code>d &lt; a</code>, then (Equation 14):</li>
</ul>
<p><img src="clip_image014.png" width="177"></p>
</div>
<div id="spearmans-rank-correlation-coefficient-spearman-equation-15" class="section level4">
<h4 class="hasAnchor">
<a href="#spearmans-rank-correlation-coefficient-spearman-equation-15" class="anchor"></a>8. Spearman’s rank correlation coefficient <code>Spearman</code> (Equation 15)</h4>
<p><img src="clip_image015.png" width="293"></p>
</div>
<div id="pearsons-correlation-coefficient-pearson-equation-16" class="section level4">
<h4 class="hasAnchor">
<a href="#pearsons-correlation-coefficient-pearson-equation-16" class="anchor"></a>9. Pearson’s correlation coefficient <code>Pearson</code> (Equation 16)</h4>
<p><img src="clip_image016.png" width="400"></p>
</div>
</div>
</div>
<div id="calculating-niche-width-1" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-niche-width-1" class="anchor"></a>3.3 Calculating niche width</h2>
<p>Niche width is commonly measured by the Levins or Shannon indices.</p>
<div id="levins-niche-width-index-equation-17" class="section level3">
<h3 class="hasAnchor">
<a href="#levins-niche-width-index-equation-17" class="anchor"></a>1. Levins niche width index (Equation 17)</h3>
<p><img src="clip_image017.png" width="172"></p>
</div>
<div id="shannons-niche-width-index-equation-18" class="section level3">
<h3 class="hasAnchor">
<a href="#shannons-niche-width-index-equation-18" class="anchor"></a>2. Shannon’s niche width index (Equation 18)</h3>
<p><img src="clip_image018.png" width="190"></p>
<p>where <em>B_i</em> is the niche width of the <em>i</em>th species, <em>j</em> denotes jth plot, and <em>r</em> denotes the number of plots.</p>
<p>The function <code><a href="../reference/niche.width.html">niche.width()</a></code> can calculate the niche width of each species. The arguments are: <code><a href="../reference/niche.width.html">niche.width(mat, method = c("shannon", "levins"))</a></code>, where <code>mat</code> is the sample-species matrix and <code>method</code> is eighther <code>"shannon"</code> or <code>"levins"</code>.</p>
</div>
</div>
<div id="niche-overlap" class="section level2">
<h2 class="hasAnchor">
<a href="#niche-overlap" class="anchor"></a>3.4 Niche overlap</h2>
<p><code><a href="../reference/niche.overlap.html">niche.overlap()</a></code> calculates the niche overlap coefficients between all species pairs, including: <code>"levins"</code> (Note this is different from niche width), <code>"schoener"</code>, <code>"petraitis"</code>, <code>"pianka"</code>, <code>"morisita"</code>, etc. The output is a distance matrix. These indices are defined as below:</p>
<div id="levins-niche-overlap-index-equation-19" class="section level3">
<h3 class="hasAnchor">
<a href="#levins-niche-overlap-index-equation-19" class="anchor"></a>1. Levin’s niche overlap index (Equation 19)</h3>
<p><img src="clip_image019.png" width="194"></p>
</div>
<div id="schoeners-niche-overlap-index-equation-20" class="section level3">
<h3 class="hasAnchor">
<a href="#schoeners-niche-overlap-index-equation-20" class="anchor"></a>2. Schoener’s niche overlap index (Equation 20)</h3>
<p><img src="clip_image020.png" width="400"></p>
</div>
<div id="petraitiss-niche-overlap-index-equation-21" class="section level3">
<h3 class="hasAnchor">
<a href="#petraitiss-niche-overlap-index-equation-21" class="anchor"></a>3. Petraitis’s niche overlap index (Equation 21)</h3>
<p><img src="clip_image021.png" width="400"></p>
</div>
<div id="piankas-niche-overlap-index-equation-22" class="section level3">
<h3 class="hasAnchor">
<a href="#piankas-niche-overlap-index-equation-22" class="anchor"></a>4. Pianka’s niche overlap index (Equation 22)</h3>
<p><img src="clip_image022.png" width="400"></p>
</div>
<div id="czechanowskis-niche-overlap-index-equation-23" class="section level3">
<h3 class="hasAnchor">
<a href="#czechanowskis-niche-overlap-index-equation-23" class="anchor"></a>5. Czechanowski’s niche overlap index (Equation 23)</h3>
<p><img src="clip_image023.png" width="330"></p>
</div>
<div id="the-simplified-morisita-index-equation-24" class="section level3">
<h3 class="hasAnchor">
<a href="#the-simplified-morisita-index-equation-24" class="anchor"></a>6. the simplified Morisita index (Equation 24)</h3>
<p><img src="clip_image024.png" width="270"></p>
<p>where <em>O_ik</em> is the niche overlap of species <em>i</em> and species<em>k</em>, <em>P_ij</em> and <em>P_kj</em> are the number of individuals of species <em>i</em> and species <em>k</em> in the <em>j</em>th sample, respectively, <em>r</em> is the total number of plots (sites), and <em>e</em> is the base of the natural logarithm.</p>
</div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example:</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">datasample</span><span class="op">)</span>
<span class="fu"><a href="../reference/niche.overlap.html">niche.overlap</a></span><span class="op">(</span><span class="va">mat</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"levins"</span>, <span class="st">"schoener"</span>, <span class="st">"petraitis"</span>, <span class="st">"pianka"</span>, <span class="st">"czech"</span>, <span class="st">"morisita"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>where <code>mat</code> is the community matrix and <code>method</code> is either: <code>"levins"</code>, <code>"schoener"</code>, <code>"petraitis"</code>, <code>"pianka"</code>, <code>"czech"</code> or <code>"morisita"</code>.</p>
<p><code><a href="../reference/niche.overlap.pair.html">niche.overlap.pair()</a></code> computes the niche overlap between a specific pair. For example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/niche.overlap.pair.html">niche.overlap.pair</a></span><span class="op">(</span><span class="va">vectA</span>, <span class="va">vectB</span>, 
                   method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pianka"</span>, <span class="st">"schoener"</span>, 
                              <span class="st">"petraitis"</span>, <span class="st">"czech"</span>,  
                              <span class="st">"morisita"</span>, <span class="st">"levins"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Where <code>VectA</code> and <code>vectB</code> are two vectors indicating the number of individuals of species A and species B in the plots, respectively, and <code>method</code> is either <code>"pianka", "schoener", "petraitis", "czech", "morisita", "levins"</code>.</p>
</div>
<div id="bootstrap-of-the-confidence-intervals-for-niche-width" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrap-of-the-confidence-intervals-for-niche-width" class="anchor"></a>3.5 Bootstrap of the confidence intervals for niche width</h2>
<p>The confidence interval of niche overlap between each pair of species could be estimated using bootstrap by <code><a href="../reference/niche.overlap.boot.html">niche.overlap.boot()</a></code>, which is show below:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/niche.overlap.boot.pair.html">niche.overlap.boot.pair</a></span><span class="op">(</span><span class="va">vectorA</span>, <span class="va">vectorB</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"levins"</span>,
     <span class="st">"schoener"</span>, <span class="st">"petraitis"</span>, <span class="st">"pianka"</span>, <span class="st">"czech"</span>, <span class="st">"morisita"</span><span class="op">)</span>,
      times <span class="op">=</span> <span class="fl">1000</span>, quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>where <code>mat</code> is the input species distribution matrix. <code>method</code> is the niche overlap index, <code>times</code> is the times of bootstrap to be performed, and <code>quant</code> is the quantile of the niche overlap index. By defaults,the 95% confidence interval (0.025 and 0.975) is used.</p>
<p><code><a href="../reference/niche.overlap.boot.html">niche.overlap.boot()</a></code> is a wrapper of <code><a href="../reference/niche.overlap.boot.pair.html">niche.overlap.boot.pair()</a></code>. In most cases, users do not need to call <code><a href="../reference/niche.overlap.boot.pair.html">niche.overlap.boot.pair()</a></code>.</p>
<div class="figure">
<img src="boot.jpg" alt=""><p class="caption">Confidence intervals of species niche overlap analysis</p>
</div>
<p>The columns are as follows.</p>
<ul>
<li>Row names, Species pair <code>Castanopsis.eirei-Schima.superba</code> for both columns, indicating the corresponding species pair</li>
<li>
<code>Observed</code>: the valued niche overlap index used</li>
<li>
<code>Boot mean</code>: the mean of bootstrap niche overlap index</li>
<li>
<code>Boot std</code>: the standard deviation (sd()) of the niche overlap index</li>
<li>
<code>Boot CI1</code>: the lower quantile of the niche overlap index, the default is the 0.025 quantile</li>
<li>
<code>Boot CI2</code>: the upper quantile of the niche overlap index, the default is the 0.975 quantile</li>
</ul>
<p>Note: If a species is missing, NaN will appear during in the bootstrap results, which indicates that the denominators is 0.</p>
</div>
<div id="visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#visualisation" class="anchor"></a>3.6 Visualisation</h2>
<div id="semi-matrix-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#semi-matrix-plots" class="anchor"></a>3.6.1 Semi-matrix plots</h3>
<p>The spaa package also provides some functions for visualising the results of species association.</p>
<p><img src="correlation.jpeg" width="400"></p>
<p>The arguments are:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotlowertri.html">plotlowertri</a></span><span class="op">(</span><span class="va">input</span>, valuename <span class="op">=</span> <span class="st">"r"</span>,  
    pchlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">17</span>, <span class="fl">15</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span>, 
    interval <span class="op">=</span> <span class="fl">6</span>,  cex <span class="op">=</span> <span class="fl">1</span>, ncex <span class="op">=</span> <span class="fl">1</span>, 
    int <span class="op">=</span><span class="fl">1.2</span>, add.number <span class="op">=</span> <span class="cn">TRUE</span>, 
    size <span class="op">=</span> <span class="cn">FALSE</span>,  add.text <span class="op">=</span> <span class="cn">FALSE</span>,  
    show.legend <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>A correlation coefficient matrix or a distance matrix could easily be visuallized using this function (Figure 1).</p>
</div>
<div id="species-association-network" class="section level3">
<h3 class="hasAnchor">
<a href="#species-association-network" class="anchor"></a>3.6.2 Species association network</h3>
<p>Networks can be used to show the interconnectedness of species, i.e., in different colors, line widths, or line styles connecting the species to another other, or the similarity of species composition between sites. spaa’s <code><a href="../reference/plotnetwork.html">plotnetwork()</a></code> can visualize the relationship (Figure 3). However, network plot should not be used to represent the relationship between a large number of species, for example, more than 10, it could be too crowded.</p>
<p><img src="network.jpeg" width="400"></p>
<p>A network plot generated using <code><a href="../reference/plotnetwork.html">plotnetwork()</a></code></p>
</div>
</div>
<div id="other-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#other-functions" class="anchor"></a>3.7 Other functions</h2>
<div id="obtain-the-most-frequently-occurred-species-in-the-community-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#obtain-the-most-frequently-occurred-species-in-the-community-matrix" class="anchor"></a>3.7.1 Obtain the most frequently occurred species in the community matrix</h3>
<p>the <code><a href="../reference/sub.sp.matrix.html">sub.sp.matrix(spmatrix, freq = 0.5, common = NULL)</a></code> can select the species based on relative frequency, for example, <code>freq = 0.5</code> will only keep the species whose relative frequency greater than 0.5, or <code>common = 10</code> will select the top 10 species with highest relative frequency.</p>
</div>
<div id="other-useful-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#other-useful-functions" class="anchor"></a>3.7.2 Other useful functions</h3>
<p>Note: These functions were available before the version 0.2.0, but have been removed from the development. I am planning to re-include them in <code>spaa</code> in the near future.</p>
<ul>
<li>
<code>lgeodist()</code>, <code>geodist()</code> calculates the great circle distance between two locations given their latitude and longitude;</li>
<li>
<code>deg2dec()</code> converts degrees, minutes and seconds to decimal degrees;</li>
<li>
<code>dist2list()</code> converts distance matrix to a data.frame, similar to <code><a href="https://rdrr.io/pkg/simba/man/liste.html">simba::liste()</a></code>
</li>
<li>
<code>turnover()</code> calculates species turnover, and could be used in computing beta diversity for forest dynamic plot</li>
<li>
<code>lab.mat()</code> and <code>XYname()</code> can generate the names of quadrats of a forest dynamic plot.</li>
<li>
<code>add.col()</code> will add a column to the target dataframe, if give there is one column in common among the two data.frames. Note this is experimental and users are encouraged to call <code><a href="https://rdrr.io/r/base/merge.html">merge()</a></code>.</li>
<li>
<code><a href="../reference/data2mat.html">data2mat()</a></code> converts dataframe to community matrix, similar to the function <code><a href="https://rdrr.io/pkg/picante/man/sample2matrix.html">picante::sample2matrix()</a></code>, see Section 3.1.2 of this tutorial for the conversion if there is a decimal number in the sample.</li>
<li>
<code>list2dist()</code> Convert pairwise list to distance matrix, a inversion to <code>dist2list()</code>.</li>
</ul>
</div>
</div>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>We thank Qiong Ding, Jihong Huang, and Dr. Zongshan Li for their help in the development of the package, Jinze Ma, Xueni Zhang, Jun Jiang, Meixiang Gao, Xiaofeng Fang, Yinyou, Wei Li, Alfredo H. Zúñiga Á., ÍsisArantes, Patricia Martínez, Wilson Martins da Silva, Jessica L. Sabo, Maud CHARLERY, Du Zhongyu, Diego Procopio, Zhan Xiaohao, Luis Fernando Gatica Mora, Zhao Wenxi, Xiao Zhengli, Jin Chao, Xing Bingwei, Pan Da, Vicente García-Navas, Jiang Huan, Clara Ruiz. Wang Lulu, Clara Ruiz González, Guo Jiaxing, Du Yuanbao, Zhong Yunjie, Wang Chenhe, Xu Heng, Zhang Wei, Hao Minhui, Suhridam Roy, Wang Yuan, Han Dayong, Yang Fan, Yao Xueqin, Wang Jing, Yang Haitao, Zheng Guiling, Yue Pengpeng, Mary Ann McLean, Bao Zhigui, Russell Bicknell. Joan Giménez Verdugo, Angela Andrea Camargo Sanabria, Xiaodan Zhao, Ramiro Logares Haurié, Simone Cappellari Rabeling, Caitlin Keating-Bitonti. Dr. Kurt Hornik and Prof. Brian Ripley, who provided some comments and suggestions on the compilation of the package, are gratefully acknowledged.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<ul>
<li><p>Ackerly, D.D. (2003) Community assembly, niche conservatism, and adaptive evolution in changing environments. International Journal of Plant Sciences, 164:S165-S184.</p></li>
<li><p>Chase, J.M. (2003) Community assembly: when should history matter? Oecologia, 136:489-498.</p></li>
<li><p>Cornwell, W.K. &amp; D.D. Ackerly (2009) Community assembly and shifts in plant trait distributions across an environmental gradient in coastal California. Ecological Monographs, 79:109-126.</p></li>
<li><p>Pavoine, S. &amp; M.Bonsall (2011) Measuring biodiversity to explain community assembly: a unified approach. Biological Reviews, 86:792-812.</p></li>
<li><p>Kent, M. (2011). <em>Vegetation description and data analysis: a practical approach</em>. John Wiley &amp; Sons.</p></li>
<li><p>Papers in Chinese are not listed here.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jinlong Zhang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
